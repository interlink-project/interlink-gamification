package eu.trentorise.game.model
import eu.trentorise.game.core.Utility;
//declare any global variables here
global Utility utils;

rule "update_exploitation_points"
when
    InputData( $exploitation : data["exploitation"])
    InputData( $exploitComplexity : data["exploitComplexity"])
    InputData( $revertPoints : data["revertPoints"])
    $pc : PointConcept(name == "exploitation")
then
    utils.log("apply \'update exploitation points\'");
    Double exploitation = $exploitation != null ? (Double) $exploitation : 0;
    Double exploitComplexity = $exploitComplexity != null ? (Double) $exploitComplexity : 0;
    
   	if ($revertPoints != null) {
    	utils.log("revert exploitation points");
    	if ($pc.getScore() - (exploitation * exploitComplexity) < 0) {
    		$pc.setScore(0d);
    	} else {
    		$pc.setScore($pc.getScore() - (exploitation * exploitComplexity));
    	}
    } else {
    	$pc.setScore($pc.getScore() + (exploitation * exploitComplexity));
    }
    update($pc);
end